<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>KONVEN & EF</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #1a1a1a;
      overflow: hidden;
      width: 100vw;
      height: 100vh;
      touch-action: none;
    }
    #imageContainer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      cursor: grab;
      background: #000;
    }
    #imageContainer.grabbing {
      cursor: grabbing;
    }
    .image-wrapper {
      position: absolute;
      left: 50%;
      top: 50%;
      transform-origin: 0 0;
      user-select: none;
      -webkit-user-drag: none;
      pointer-events: none;
    }
    .image-wrapper img {
      display: block;
      max-width: none;
    }
    .controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 100;
      background: rgba(0, 0, 0, 0.7);
      padding: 15px 20px;
      border-radius: 50px;
      backdrop-filter: blur(10px);
      flex-wrap: wrap;
      justify-content: center;
      max-width: 95vw;
    }
    button {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      white-space: nowrap;
    }
    button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.05);
    }
    button:active {
      transform: scale(0.95);
    }
    button.active {
      background: rgba(102, 126, 234, 0.6);
      border-color: rgba(102, 126, 234, 0.8);
    }
    .zoom-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      z-index: 100;
      backdrop-filter: blur(10px);
    }
    .image-title {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      z-index: 100;
      backdrop-filter: blur(10px);
      font-weight: 600;
    }
    .loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 18px;
      z-index: 50;
      display: none;
    }
    .loading.active {
      display: block;
    }
    @media (max-width: 768px) {
      .controls {
        bottom: 10px;
        padding: 10px 15px;
        gap: 5px;
      }
      button {
        padding: 8px 12px;
        font-size: 12px;
      }
      .zoom-indicator, .image-title {
        font-size: 12px;
        padding: 8px 15px;
      }
    }
  </style>
</head>
<body>
  <div id="imageContainer">
    <div class="image-wrapper" id="imageWrapper"></div>
  </div>

  <div class="loading" id="loading">‚è≥ Memuat gambar...</div>
  <div class="zoom-indicator" id="zoomIndicator">100%</div>
  <div class="image-title" id="imageTitle">‚ö° EF</div>

  <div class="controls">
    <button onclick="switchImage('ef')" id="btnEf" class="active">‚ö° EF</button>
    <button onclick="switchImage('konven')" id="btnKonven">üè¢ Konven</button>
    <button onclick="zoomIn()">üîç+</button>
    <button onclick="zoomOut()">üîç‚àí</button>
    <button onclick="resetView()">‚Ü∫ Reset</button>
    <button onclick="fitToScreen()">‚õ∂ Fit</button>
    <button onclick="openWebsite()">üì± Konven</button>
    <button onclick="openWebsite1()">üåê Ebifry</button>
    <button onclick="openWebsite2()">üñ•Ô∏è Spreadsheet</button>
    <button onclick="downloadImage()">‚¨á</button>
    <button onclick="refreshImage()">üîÑ</button>
  </div>

  <script>
    const container = document.getElementById('imageContainer');
    const imageWrapper = document.getElementById('imageWrapper');
    const loading = document.getElementById('loading');
    const zoomIndicator = document.getElementById('zoomIndicator');
    const imageTitle = document.getElementById('imageTitle');

    const images = {
      konven: {
        url: "https://www.dropbox.com/scl/fi/2qkhqeknt7ma7ceeiyg37/KONVEN.jpeg?rlkey=es21x6ex9b22m8h27qrck4xjo&raw=1",
        title: "üè¢ KONVEN",
        filename: "KONVEN.jpeg"
      },
      ef: {
        url: "https://www.dropbox.com/scl/fi/wmp0t6yq6itguntm1e9o6/EF.jpeg?rlkey=g1v7mst03plmsuneneed4tfrg&raw=1",
        title: "‚ö° EF",
        filename: "EF.jpeg"
      }
    };

    let currentImage = 'ef';
    let scale = 1;
    let posX = 0;
    let posY = 0;
    let isDragging = false;
    let startX, startY;
    let initialDistance = 0;
    let initialScale = 1;
    let touchStartX = 0;
    let touchStartY = 0;

    function switchImage(imageKey) {
      if (currentImage === imageKey) return;
      
      currentImage = imageKey;
      
      document.querySelectorAll('.controls button').forEach(btn => btn.classList.remove('active'));
      document.getElementById('btn' + imageKey.charAt(0).toUpperCase() + imageKey.slice(1)).classList.add('active');
      
      loadImage();
    }

    function loadImage() {
      loading.classList.add('active');
      const imageData = images[currentImage];
      const noCacheUrl = `${imageData.url}&t=${Date.now()}`;
      
      const img = new Image();
      img.onload = () => {
        imageWrapper.innerHTML = '';
        imageWrapper.appendChild(img);
        loading.classList.remove('active');
        imageTitle.textContent = imageData.title;
        fitToScreen();
      };
      
      img.onerror = () => {
        loading.textContent = '‚ùå Gagal memuat gambar';
        loading.classList.add('active');
      };
      
      img.src = noCacheUrl;
    }

    function updateTransform() {
      imageWrapper.style.transform = `translate(calc(-50% + ${posX}px), calc(-50% + ${posY}px)) scale(${scale})`;
      zoomIndicator.textContent = `${Math.round(scale * 100)}%`;
    }

    function fitToScreen() {
      const img = imageWrapper.querySelector('img');
      if (!img || !img.complete) return;

      const containerWidth = container.clientWidth;
      const containerHeight = container.clientHeight;
      const imgWidth = img.naturalWidth;
      const imgHeight = img.naturalHeight;

      if (imgWidth === 0 || imgHeight === 0) return;

      const scaleX = containerWidth / imgWidth;
      const scaleY = containerHeight / imgHeight;
      scale = Math.min(scaleX, scaleY) * 0.95;

      // Reset ke tengah
      posX = 0;
      posY = 0;
      imageWrapper.style.left = '50%';
      imageWrapper.style.top = '50%';
      updateTransform();
    }

    function resetView() {
      scale = 1;
      posX = 0;
      posY = 0;
      imageWrapper.style.left = '50%';
      imageWrapper.style.top = '50%';
      updateTransform();
    }

    function zoomIn() {
      scale = Math.min(scale * 1.3, 4);
      updateTransform();
    }

    function zoomOut() {
      scale = Math.max(scale / 1.3, 0.1);
      updateTransform();
    }

    function downloadImage() {
      const img = imageWrapper.querySelector('img');
      if (!img) return;
      
      const link = document.createElement('a');
      link.href = img.src;
      link.download = images[currentImage].filename;
      link.click();
    }

    function refreshImage() {
      loadImage();
    }

    function openWebsite() {
      window.open('https://ppicwkb.github.io/Stock/', '_blank');
    }

    function openWebsite1() {
      window.open('https://ppicwkb.github.io/ebifry/', '_blank');
    }
    function openWebsite2() {
      window.open('https://docs.google.com/spreadsheets/d/1xBb45gW7WZM9xOtzy8qlau-VGfqJKU1w6GvB_eVjius/edit?gid=57660292#gid=57660292', '_blank');
    }  


    // Mouse drag
    container.addEventListener('mousedown', (e) => {
      isDragging = true;
      container.classList.add('grabbing');
      startX = e.clientX - posX;
      startY = e.clientY - posY;
    });

    container.addEventListener('mousemove', (e) => {
      if (!isDragging) return;
      e.preventDefault();
      posX = e.clientX - startX;
      posY = e.clientY - startY;
      updateTransform();
    });

    container.addEventListener('mouseup', () => {
      isDragging = false;
      container.classList.remove('grabbing');
    });

    container.addEventListener('mouseleave', () => {
      isDragging = false;
      container.classList.remove('grabbing');
    });

    // Mouse wheel zoom
    container.addEventListener('wheel', (e) => {
      e.preventDefault();
      
      const rect = container.getBoundingClientRect();
      const wrapperRect = imageWrapper.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      
      // Hitung posisi mouse relatif terhadap center
      const centerX = rect.width / 2;
      const centerY = rect.height / 2;
      const offsetX = mouseX - centerX;
      const offsetY = mouseY - centerY;
      
      const oldScale = scale;
      const delta = e.deltaY > 0 ? 0.9 : 1.1;
      scale = Math.max(0.1, Math.min(4, scale * delta));
      
      const scaleChange = scale / oldScale;
      posX = posX + offsetX - offsetX * scaleChange;
      posY = posY + offsetY - offsetY * scaleChange;
      
      updateTransform();
    }, { passive: false });

    // Touch helpers
    function getTouchDistance(touches) {
      const dx = touches[0].clientX - touches[1].clientX;
      const dy = touches[0].clientY - touches[1].clientY;
      return Math.sqrt(dx * dx + dy * dy);
    }

    function getTouchCenter(touches) {
      return {
        x: (touches[0].clientX + touches[1].clientX) / 2,
        y: (touches[0].clientY + touches[1].clientY) / 2
      };
    }

    let touchCenter = { x: 0, y: 0 };

    container.addEventListener('touchstart', (e) => {
      if (e.touches.length === 1) {
        touchStartX = e.touches[0].clientX - posX;
        touchStartY = e.touches[0].clientY - posY;
      } else if (e.touches.length === 2) {
        e.preventDefault();
        initialDistance = getTouchDistance(e.touches);
        initialScale = scale;
        touchCenter = getTouchCenter(e.touches);
      }
    }, { passive: false });

    container.addEventListener('touchmove', (e) => {
      e.preventDefault();
      
      if (e.touches.length === 1) {
        posX = e.touches[0].clientX - touchStartX;
        posY = e.touches[0].clientY - touchStartY;
        updateTransform();
      } else if (e.touches.length === 2) {
        const currentDistance = getTouchDistance(e.touches);
        const currentCenter = getTouchCenter(e.touches);
        
        const rect = container.getBoundingClientRect();
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        
        const offsetX = currentCenter.x - centerX;
        const offsetY = currentCenter.y - centerY;
        
        const oldScale = scale;
        scale = Math.max(0.1, Math.min(4, initialScale * (currentDistance / initialDistance)));
        
        const scaleChange = scale / oldScale;
        posX = posX + offsetX - offsetX * scaleChange;
        posY = posY + offsetY - offsetY * scaleChange;
        
        updateTransform();
      }
    }, { passive: false });

    // Double tap zoom
    let lastTap = 0;
    container.addEventListener('touchend', (e) => {
      const currentTime = new Date().getTime();
      const tapLength = currentTime - lastTap;
      if (tapLength < 300 && tapLength > 0 && e.touches.length === 0) {
        e.preventDefault();
        if (scale > 1.5) {
          fitToScreen();
        } else {
          const rect = container.getBoundingClientRect();
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const oldScale = scale;
          scale = 2.5;
          
          const scaleChange = scale / oldScale;
          posX = centerX - (centerX - posX) * scaleChange;
          posY = centerY - (centerY - posY) * scaleChange;
          
          updateTransform();
        }
      }
      lastTap = currentTime;
    });

    // Load first image
    loadImage();
  </script>
</body>
</html>
